# 🐳 Ta-Go Docker 배포 가이드

## 개요

이 가이드는 Ta-Go 프로젝트를 Docker를 사용하여 72.60.40.57 서버에 배포하는 방법을 설명합니다.

## 사전 요구사항

- Docker 및 Docker Compose가 설치된 서버
- 72.60.40.57 서버에 SSH 접근 권한
- Git 저장소 접근 권한

## 배포 단계

### 1. 서버에 프로젝트 클론

```bash
# 서버에 SSH 접속
ssh root@72.60.40.57

# 프로젝트 디렉토리로 이동
cd /var/www

# 프로젝트 클론
git clone <your-repository-url> ta-go
cd ta-go
```

### 2. 환경 변수 설정

```bash
# env.docker 파일을 .env로 복사
cp env.docker .env

# 필요한 환경 변수 수정
nano .env
```

### 3. Docker 빌드 및 실행

```bash
# 전체 스택 빌드
docker-compose build

# 컨테이너 시작
docker-compose up -d

# 로그 확인
docker-compose logs -f
```

## 개별 서비스 관리

### 프론트엔드만 재배포
```bash
docker-compose build ta-go-frontend
docker-compose up -d ta-go-frontend
```

### 백엔드만 재시작
```bash
docker-compose restart ta-ja-api
```

### 로그 확인
```bash
docker-compose logs -f ta-go-frontend
docker-compose logs -f ta-ja-api
```

## 모니터링

### 컨테이너 상태 확인
```bash
docker-compose ps
```

### 헬스체크
```bash
docker-compose ps | grep healthy
```

## 데이터베이스 서비스 (필요시)

```bash
# MongoDB, PostgreSQL, Redis 서비스 시작
docker-compose up -d ta-ja-mongodb ta-ja-postgres ta-ja-redis
```

## 문제 해결

### 포트 충돌
```bash
# 포트 사용 확인
netstat -tlnp | grep :3000
netstat -tlnp | grep :3011

# 기존 프로세스 종료
sudo lsof -ti:3000 | xargs kill -9
sudo lsof -ti:3011 | xargs kill -9
```

### 컨테이너 재시작
```bash
# 모든 컨테이너 재시작
docker-compose restart

# 특정 컨테이너 재시작
docker-compose restart ta-go-frontend
```

### 로그 확인
```bash
# 실시간 로그
docker-compose logs -f

# 특정 서비스 로그
docker-compose logs -f ta-go-frontend
```

## 배포 스크립트 사용

### 전체 배포
```bash
./deploy.sh
```

### 빠른 배포
```bash
./quick-deploy.sh
```

### 캐시 클리어
```bash
./clear-cache.sh
```

## 접속 URL

- **프론트엔드**: http://72.60.40.57:3011
- **백엔드 API**: http://72.60.40.57:3000
- **GraphQL**: http://72.60.40.57:3000/graphql
- **헬스체크**: http://72.60.40.57:3000/health

## 보안 고려사항

1. 환경 변수 파일(.env)의 민감한 정보 보호
2. SSL 인증서 설정 (HTTPS)
3. 방화벽 설정
4. 정기적인 보안 업데이트

---

**마지막 업데이트**: 2024년 12월
**버전**: 1.0.0
